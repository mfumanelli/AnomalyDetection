########## NB numero totale loop gd = numbers_gd_loops x 4

# DATI 5% SEGNALE
### prova = gradient(numbers_gd_loops=250, differenza_ZPL=0.8, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True)

{'scatola_migliore': {'box_volume': 0.0021331922011975637, 'box_vol_sidebands': 0.0033862315442313726, 'box_IN': 47, 'box_ZPLtau': 33.267227846152224, 'Blockmin': array([0.39233691, 0.33876621, 0.31014993, 0.35392793, 0.        ,
       0.        ]), 'Blockmax': array([0.48101205, 0.62744134, 0.59882506, 0.64260307, 1.        ,
       1.        ]), 'subspace_idx': array([10,  0, 12, 13,  4,  8]), 'included_points': array([ 122,  286,  544,  614,  650,  685,  733, 1027, 1252, 1334, 1920,
       1965, 2325, 2929, 3013, 3118, 3542, 3672, 3883, 4050, 4255, 4352,
       4661, 4812, 4845, 5620, 5905, 5918, 6172, 6407, 6460, 6590, 6928,
       7031, 7208, 7273, 7426, 7434, 7489, 7557, 7569, 7720, 8700, 9310,
       9388, 9660, 9935])}, 'percentuale_segnale': 0.723404255319149}

### prova = gradient(numbers_gd_loops=250, differenza_ZPL=0.5, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True)

{'scatola_migliore': {'box_volume': 0.002133192201197562, 'box_vol_sidebands': 0.00338623154423137, 'box_IN': 104, 'box_ZPLtau': 30.344796625809508, 'Blockmin': array([0.37873978, 0.32419516, 0.37472045, 0.3359004 , 0.        ,
       0.        ]), 'Blockmax': array([0.66741492, 0.4128703 , 0.66339558, 0.62457554, 1.        ,
       1.        ]), 'subspace_idx': array([ 4, 13, 12, 10,  2,  5]), 'included_points': array([  14,   47,  195,  294,  374,  486,  572,  626,  650,  685,  977,
       1093, 1258, 1598, 1636, 1748, 1850, 1916, 1927, 1965, 2092, 2132,
       2163, 2205, 2238, 2369, 2393, 2470, 2510, 2512, 2573, 2594, 2610,
       2759, 2813, 2824, 2902, 3140, 3319, 3369, 3693, 3733, 3824, 3899,
       3919, 3926, 3963, 4042, 4050, 4087, 4147, 4255, 4374, 4502, 4597,
       4713, 4795, 4999, 5332, 5446, 5460, 5560, 5694, 5834, 5848, 5901,
       6006, 6110, 6439, 6453, 6637, 6815, 7327, 7365, 7384, 7484, 7557,
       7573, 7664, 7685, 8149, 8182, 8392, 8565, 8708, 8761, 8880, 8948,
       8958, 9036, 9104, 9112, 9310, 9338, 9344, 9385, 9387, 9388, 9520,
       9563, 9633, 9828, 9831, 9978])}, 'percentuale_segnale': 0.8557692307692307}

### prova = gradient(numbers_gd_loops=250, differenza_ZPL=0.3, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True)
{'scatola_migliore': {'box_volume': 0.0021331922011975646, 'box_vol_sidebands': 0.003386231544231374, 'box_IN': 51, 'box_ZPLtau': 43.439039983669495, 'Blockmin': array([0.31024265, 0.35892047, 0.44485871, 0.35969048, 0.        ,
       0.        ]), 'Blockmax': array([0.39891779, 0.6475956 , 0.73353384, 0.64836562, 1.        ,
       1.        ]), 'subspace_idx': array([ 4,  0,  3, 10, 13, 18]), 'included_points': array([  22,  279,  424,  679,  902, 1094, 1215, 1338, 1748, 1920, 2015,
       2341, 2481, 2609, 2787, 3157, 3212, 3232, 3355, 3360, 3391, 3617,
       3708, 4040, 4227, 4320, 4383, 4403, 4894, 4961, 5824, 5978, 6445,
       6520, 6921, 6931, 6939, 6987, 7129, 7573, 7590, 7664, 8154, 8271,
       8302, 8558, 8644, 8703, 8921, 9565, 9660])}, 'percentuale_segnale': 0.7647058823529411}

### prova = gradient(numbers_gd_loops=250, differenza_ZPL=1, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True)

{'scatola_migliore': {'box_volume': 0.002133192201197563, 'box_vol_sidebands': 0.003386231544231371, 'box_IN': 24, 'box_ZPLtau': 34.800454727917845, 'Blockmin': array([0.34981075, 0.37691446, 0.24585584, 0.32108984, 0.        ,
       0.        ]), 'Blockmax': array([0.43848588, 0.6655896 , 0.53453097, 0.60976497, 1.        ,
       1.        ]), 'subspace_idx': array([10,  3, 16,  4,  0,  6]), 'included_points': array([ 101,  122,  137,  860, 1213, 1523, 3670, 3883, 4039, 4376, 4663,
       5136, 5695, 5837, 6180, 6584, 6975, 7086, 7187, 7193, 7557, 7653,
       7699, 9395])}, 'percentuale_segnale': 0.125}

# DATI 2% SEGNALE
### prova = gradient(numbers_gd_loops=250, differenza_ZPL=0.8, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True)


{'scatola_migliore': {'box_volume': 0.002133192201197562, 'box_vol_sidebands': 0.00338623154423137, 'box_IN': 64, 'box_ZPLtau': 14.297911270572465, 'Blockmin': array([0.32137015, 0.44171862, 0.42087922, 0.2752614 , 0.        ,
       0.        ]), 'Blockmax': array([0.41004528, 0.73039376, 0.70955435, 0.56393653, 1.        ,
       1.        ]), 'subspace_idx': array([18, 17, 16, 12,  7, 14]), 'included_points': array([  91,  304,  754, 1119, 1469, 1471, 1613, 1788, 1872, 1924, 2447,
       2528, 2652, 2769, 3215, 3223, 3592, 3595, 3751, 3826, 3881, 4021,
       4059, 4061, 4282, 4318, 4320, 4349, 4382, 4410, 4581, 4976, 5034,
       5122, 5201, 5683, 5736, 5776, 5909, 6039, 6163, 6286, 6810, 7117,
       7146, 7258, 7291, 7388, 7630, 7641, 7647, 8050, 8059, 8091, 8226,
       8487, 8684, 8838, 9350, 9439, 9517, 9742, 9818, 9852])}, 'percentuale_segnale': 0.703125}

### prova = gradient(numbers_gd_loops=250, differenza_ZPL=0.5, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True)

{'scatola_migliore': {'box_volume': 0.0021331922011975637, 'box_vol_sidebands': 0.003386231544231372, 'box_IN': 31, 'box_ZPLtau': 13.332476050256131, 'Blockmin': array([0.38683451, 0.34884973, 0.26449788, 0.25518126, 0.        ,
       0.        ]), 'Blockmax': array([0.47550965, 0.63752486, 0.55317302, 0.54385639, 1.        ,
       1.        ]), 'subspace_idx': array([16,  8,  3, 10,  4,  5]), 'included_points': array([ 152,  510,  783, 1085, 1427, 1919, 2004, 2451, 2579, 2806, 2826,
       3758, 4389, 5034, 5222, 6104, 6443, 6651, 6757, 6764, 6845, 6858,
       7349, 7480, 7641, 7698, 7990, 8375, 8426, 9016, 9121])}, 'percentuale_segnale': 0.2903225806451613}

### prova = gradient(numbers_gd_loops=250, differenza_ZPL=0.3, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True)
{'scatola_migliore': {'box_volume': 0.002133192201197564, 'box_vol_sidebands': 0.003386231544231372, 'box_IN': 35, 'box_ZPLtau': 16.15739616011431, 'Blockmin': array([0.19104745, 0.34715084, 0.32010126, 0.35703406, 0.        ,
       0.        ]), 'Blockmax': array([0.27972258, 0.63582598, 0.6087764 , 0.64570919, 1.        ,
       1.        ]), 'subspace_idx': array([10, 16,  3,  8, 17,  4]), 'included_points': array([ 152,  180,  837, 1184, 1619, 1852, 2353, 2438, 2804, 2994, 3652,
       3852, 4116, 4301, 4636, 4642, 5163, 5307, 5346, 5480, 5824, 6205,
       6236, 6302, 6634, 6651, 7118, 7258, 7295, 7480, 7577, 9149, 9233,
       9696, 9841])}, 'percentuale_segnale': 0.2857142857142857}

### prova = gradient(numbers_gd_loops=250, differenza_ZPL=1, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True)
{'scatola_migliore': {'box_volume': 0.0021331922011975637, 'box_vol_sidebands': 0.003386231544231372, 'box_IN': 31, 'box_ZPLtau': 15.929761906774067, 'Blockmin': array([0.39924278, 0.36231234, 0.29549589, 0.29380206, 0.        ,
       0.        ]), 'Blockmax': array([0.48791791, 0.65098747, 0.58417102, 0.5824772 , 1.        ,
       1.        ]), 'subspace_idx': array([ 3, 17,  5, 18, 11, 12]), 'included_points': array([ 180,  312,  508,  853, 1008, 1077, 1279, 1872, 2193, 2976, 3569,
       3578, 3796, 4316, 4951, 5034, 5235, 5481, 5736, 5972, 6113, 6310,
       6610, 6763, 7291, 7298, 7556, 7999, 8200, 8901, 9295])}, 'percentuale_segnale': 0.5161290322580645}

### prova = gradient(numbers_gd_loops=250, differenza_ZPL=0.5, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True) DF 5% ZPL BAYESIANA

{'scatola_migliore': {'box_volume': 0.0021331922011975663, 'box_vol_sidebands': 0.003386231544231376, 'box_IN': 106, 'box_ZPLtau': 32.19730126912994, 'Blockmin': array([0.3164159 , 0.33574052, 0.37300536, 0.34469606, 0.        ,
       0.        ]), 'Blockmax': array([0.40509103, 0.62441566, 0.66168049, 0.63337119, 1.        ,
       1.        ]), 'subspace_idx': array([13,  4, 12, 10,  8,  3]), 'included_points': array([  14,   39,   47,  195,  294,  486,  572,  626,  685,  775,  977,
       1093, 1215, 1258, 1598, 1636, 1748, 1795, 1850, 1916, 1927, 1965,
       2092, 2132, 2163, 2205, 2238, 2369, 2393, 2470, 2510, 2512, 2573,
       2594, 2610, 2759, 2813, 2824, 2902, 3140, 3319, 3369, 3506, 3708,
       3733, 3899, 3926, 3933, 3963, 4042, 4050, 4087, 4255, 4320, 4374,
       4597, 4713, 4795, 5269, 5318, 5332, 5446, 5460, 5694, 5834, 5848,
       6006, 6110, 6439, 6445, 6453, 6637, 6815, 6987, 7327, 7384, 7484,
       7557, 7573, 7685, 8149, 8182, 8392, 8565, 8708, 8761, 8880, 8948,
       8958, 9036, 9104, 9112, 9310, 9338, 9344, 9385, 9387, 9388, 9485,
       9563, 9619, 9633, 9723, 9828, 9885, 9978])}, 'percentuale_segnale': 0.839622641509434}

### prova = gradient(numbers_gd_loops=250, differenza_ZPL=0.5, X=X_df_trasf, R2_alg_orig=False, ZPLtau_alg_orig=True) DF 2% ZPL BAYESIANA

{'scatola_migliore': {'box_volume': 0.002133192201197562, 'box_vol_sidebands': 0.003386231544231369, 'box_IN': 24, 'box_ZPLtau': 20.7760917820191, 'Blockmin': array([0.37776652, 0.45841505, 0.26147771, 0.38437682, 0.        ,
       0.        ]), 'Blockmax': array([0.46644166, 0.74709019, 0.55015284, 0.67305196, 1.        ,
       1.        ]), 'subspace_idx': array([ 8,  6, 18, 17,  7, 11]), 'included_points': array([ 685, 1119, 1435, 2469, 2598, 2858, 3595, 4502, 4795, 4965, 5000,
       5028, 5167, 5569, 5855, 6887, 6925, 7002, 7647, 8300, 8487, 8780,
       9088, 9882])}, 'percentuale_segnale': 0.2916666666666667}

# dati originali 5%
 prova = gradient(numbers_gd_loops=250,differenza_ZPL=0.5,X=X_df_trasf,R2_alg_orig=False,ZPLtau_alg_orig=False,ZPL_bayes_alg=False,ZPL_unico_alg=True,)


{'scatola_migliore': {'box_volume': 0.002133192201197563, 'box_vol_sidebands': 0.0033862315442313717, 'box_IN': 20, 'box_ZPLtau': 43.01166681254144, 'Blockmin': array([0.35808533, 0.31266525, 0.4455818 , 0.35662834, 0.        ,
       0.        ]), 'Blockmax': array([0.44676047, 0.60134038, 0.73425694, 0.64530348, 1.        ,
       1.        ]), 'subspace_idx': array([10,  4,  3, 13, 19,  7]), 'included_points': array([ 122, 1730, 2325, 2450, 3013, 3581, 3883, 4669, 4725, 5549, 5592,
       5695, 5905, 6107, 6589, 6975, 7557, 7720, 8703, 9660])}, 'percentuale_segnale': 0.4}

 prova = gradient(numbers_gd_loops=250,differenza_ZPL=0.8,X=X_df_trasf,R2_alg_orig=False,ZPLtau_alg_orig=False,ZPL_bayes_alg=False,ZPL_unico_alg=True,) 5%

{'scatola_migliore': {'box_volume': 0.002133192201197563, 'box_vol_sidebands': 0.0033862315442313717, 'box_IN': 65, 'box_ZPLtau': 39.057045621784475, 'Blockmin': array([0.3897745 , 0.27159414, 0.34579944, 0.39603767, 0.        ,
       0.        ]), 'Blockmax': array([0.47844963, 0.56026928, 0.63447458, 0.68471281, 1.        ,
       1.        ]), 'subspace_idx': array([10, 13,  4,  3,  0,  9]), 'included_points': array([  47,  122,  286,  407,  614,  650,  892, 1027, 1252, 1303, 1334,
       1681, 1748, 1920, 1965, 2056, 2132, 2325, 2688, 3010, 3013, 3118,
       3121, 3313, 3628, 3672, 3883, 4040, 4255, 4352, 4725, 5460, 5549,
       5553, 5592, 5759, 5814, 5905, 5918, 6107, 6210, 6407, 6460, 6590,
       6645, 6931, 7031, 7208, 7384, 7557, 7699, 7720, 8095, 8125, 8700,
       9018, 9055, 9310, 9344, 9388, 9463, 9580, 9619, 9660, 9935])}, 'percentuale_segnale': 0.7384615384615385}


 prova = gradient(numbers_gd_loops=250,differenza_ZPL=0.8,X=X_df_trasf,R2_alg_orig=False,ZPLtau_alg_orig=False,ZPL_bayes_alg=False,ZPL_unico_alg=True,) 2%
{'scatola_migliore': {'box_volume': 0.002133192201197562, 'box_vol_sidebands': 0.00338623154423137, 'box_IN': 41, 'box_ZPLtau': 21.384439833225887, 'Blockmin': array([0.38980551, 0.40679876, 0.41220929, 0.30149252, 0.        ,
       0.        ]), 'Blockmax': array([0.47848065, 0.6954739 , 0.70088442, 0.59016766, 1.        ,
       1.        ]), 'subspace_idx': array([17,  3,  8, 18, 16, 12]), 'included_points': array([ 260,  312,  718,  894, 1089, 1246, 1430, 1469, 1471, 1734, 1900,
       1969, 2317, 2598, 2651, 3754, 4133, 4453, 4690, 5556, 6113, 6344,
       6757, 7146, 7289, 7298, 7445, 7588, 7791, 7869, 8010, 8227, 8604,
       8765, 8769, 8873, 9117, 9148, 9159, 9365, 9367])}, 'percentuale_segnale': 0.5609756097560976}



PROVA CODICE ADATTIVO SEQUENZIALE
# 100 iterazioni => 21 minuti (5%)
{'scatola_migliore': {'box_volume': 0.0021331922011975637, 'box_vol_sidebands': 0.0033862315442313717, 'box_IN': 137, 'box_ZPLtau': 31.19321946304349, 'Blockmin': array([0.36049352, 0.36225562, 0.24551771, 0.35245752, 0.        ,
       0.        ]), 'Blockmax': array([0.44916865, 0.65093075, 0.53419285, 0.64113265, 1.        ,
       1.        ]), 'subspace_idx': array([ 0,  1,  2, 17,  4, 14]), 'included_points': array([  90,  124,  237,  239,  258,  322,  352,  407,  424,  544,  572,
        575,  616,  630,  645,  671,  775,  946,  977,  986, 1000, 1244,
       1303, 1433, 1444, 1463, 1636, 1696, 1795, 1866, 2000, 2010, 2032,
       2082, 2104, 2238, 2239, 2241, 2287, 2396, 2462, 2639, 2929, 2985,
       3009, 3010, 3041, 3156, 3319, 3369, 3398, 3487, 3505, 3628, 3633,
       3656, 3660, 3666, 3672, 3699, 3708, 3796, 4031, 4042, 4147, 4255,
       4290, 4300, 4347, 4380, 4390, 4426, 4518, 4713, 4715, 4856, 4880,
       4973, 5067, 5102, 5180, 5282, 5293, 5332, 5370, 5523, 5545, 5590,
       5596, 5658, 5845, 6055, 6107, 6110, 6177, 6295, 6326, 6407, 6412,
       6615, 6625, 6637, 6674, 6793, 6860, 6864, 6866, 6909, 7095, 7119,
       7129, 7378, 7487, 7557, 7573, 7579, 7683, 7687, 7716, 8164, 8194,
       8275, 8287, 8553, 8588, 8657, 8719, 8768, 8921, 9036, 9237, 9385,
       9563, 9636, 9681, 9831, 9935])}, 'percentuale_segnale': 0.9051094890510949}

# 100 x 4 iterazioni => X minuti (2%)
# prova = gradient_sequenziale(numbers_gd_loops=100, differenza_ZPL=1, soglia_pca=0.8, X=X_df_trasf, PCA_opt=False, ZPLtau_alg_orig=True,
ZPL_bayes_alg=False, ZPL_unico_alg=False, numero_slices=10,)

{'scatola_migliore': {'box_volume': 0.0021331922011975633, 'box_vol_sidebands': 0.003386231544231371, 'box_IN': 61, 'box_ZPLtau': 10.96880207312644, 'Blockmin': array([0.24483968, 0.30149252, 0.38349384, 0.31842517, 0.        ,
       0.        ]), 'Blockmax': array([0.33351482, 0.59016766, 0.67216897, 0.60710031, 1.        ,
       1.        ]), 'subspace_idx': array([ 0,  4,  1, 11, 16,  7]), 'included_points': array([ 304,  467,  613,  718,  998, 1077, 1088, 1189, 1325, 1451, 1486,
       1618, 1782, 2044, 2271, 2447, 2598, 2639, 2652, 2769, 2963, 3070,
       3094, 3215, 3284, 3595, 3659, 3782, 4021, 4059, 4061, 4230, 4537,
       5235, 5293, 5346, 5500, 5776, 6127, 6694, 6747, 6771, 6784, 7117,
       7119, 7258, 7350, 7388, 7630, 7661, 7698, 7918, 8731, 9398, 9479,
       9501, 9519, 9742, 9753, 9818, 9852])}, 'percentuale_segnale': 0.7213114754098361}

# prova con dataset 2% generato sul momento con prova = gradient_sequenziale(numbers_gd_loops=100, differenza_ZPL=1, soglia_pca=0.8, X=X_df_trasf, PCA_opt=False, ZPLtau_alg_orig=True,
ZPL_bayes_alg=False, ZPL_unico_alg=False, numero_slices=10,)


{'scatola_migliore': {'box_volume': 0.0021331922011975624, 'box_vol_sidebands': 0.0033862315442313683, 'box_IN': 27, 'box_ZPLtau': 21.182171341183178, 'Blockmin': array([0.42913956, 0.2135064 , 0.33151101, 0.31268029, 0.        ,
       0.        ]), 'Blockmax': array([0.51781469, 0.50218154, 0.62018615, 0.60135542, 1.        ,
       1.        ]), 'subspace_idx': array([ 0,  5,  1, 18, 12, 14]), 'included_points': array([1537, 1543, 2153, 2741, 2784, 3115, 3396, 3771, 4611, 4652, 4697,
       4808, 4844, 4851, 4882, 4993, 5120, 6778, 6865, 7077, 7313, 7519,
       7886, 8309, 9253, 9633, 9683])}, 'percentuale_segnale': 0.5555555555555556}

# prova 2 200 gd x 4
qui zpl_stop = 0.5
{'scatola_migliore': {'box_volume': 0.002133192201197564, 'box_vol_sidebands': 0.003386231544231371, 'box_IN': 19, 'box_ZPLtau': 18.901348775759836, 'Blockmin': array([0.48140922, 0.3987374 , 0.35057458, 0.34947715, 0.        ,
       0.        ]), 'Blockmax': array([0.57008436, 0.68741253, 0.63924972, 0.63815228, 1.        ,
       1.        ]), 'subspace_idx': array([ 2,  0,  1, 14, 12,  6]), 'included_points': array([ 151,  522,  686, 1057, 1122, 1326, 2125, 2233, 4038, 5699, 6765,
       6978, 7233, 7745, 8753, 8906, 9060, 9164, 9249])}, 'percentuale_segnale': 0.05263157894736842}
# prova 3 200 gd x 4
ZPL_stop = 0.1
{'scatola_migliore': {'box_volume': 0.002133192201197561, 'box_vol_sidebands': 0.003386231544231367, 'box_IN': 49, 'box_ZPLtau': 17.933794528881823, 'Blockmin': array([0.46260071, 0.41116432, 0.28030407, 0.25074395, 0.        ,
       0.        ]), 'Blockmax': array([0.55127585, 0.69983945, 0.5689792 , 0.53941909, 1.        ,
       1.        ]), 'subspace_idx': array([ 0,  1,  2, 17, 14,  6]), 'included_points': array([ 260,  683,  903, 1176, 1762, 1780, 1860, 2060, 2145, 2713, 2939,
       3788, 3854, 3882, 3973, 4232, 4451, 4526, 4536, 4681, 4694, 4942,
       5009, 5013, 5164, 5349, 5781, 5904, 5914, 6174, 6382, 6492, 6516,
       6699, 6796, 6933, 6959, 6996, 7080, 7256, 7448, 7493, 7641, 8152,
       8560, 9044, 9421, 9695, 9941])}, 'percentuale_segnale': 0.673469387755102}
# prova 3 800 gd x 4 dato che per ogni processore c'è un df diverso
ZPL_stop = 0.1



